id: com.alientrap.nexuiz-classic
runtime: org.freedesktop.Platform
runtime-version: '25.08'
sdk: org.freedesktop.Sdk
command: launcher.sh
finish-args:
  - --device=all
  - --socket=pulseaudio
  - --socket=wayland
  - --socket=fallback-x11
  - --share=ipc
  - --share=network
  - --persist=.nexuiz
cleanup:
- /include
- /lib/pkgconfig
- /share/aclocal
- /share/man
# launchers
- /share/nexuiz/nexuiz-linux-glx.sh
- /share/nexuiz/nexuiz-linux-sdl.sdh
# 32 bit files
- /share/nexuiz/*-686-*
# windows files
- /share/nexuiz/*.dll
- /share/nexuiz/*.exe
- /share/nexuiz/*.bat
# mac files
- /share/nexuiz/Nexuiz-SDL.app
- /share/nexuiz/Nexuiz.app
- /share/nexuiz/nexuiz-osx-dedicated
# extra files (map editor)
- /share/nexuiz/extra
# sources and docs
- /share/nexuiz/sources
- /share/nexuiz/Docs

modules:

- shared-modules/glu/glu-9.json
- shared-modules/SDL/sdl12-compat.json

- name: nexuiz-classic
  buildsystem: simple
  build-commands:
  - mkdir -p /app/bin/
  - mkdir -p /app/share/nexuiz/
  - mv * /app/share/nexuiz/
  sources:
  - type: archive
    url: https://sourceforge.net/projects/nexuiz/files/NexuizRelease/Nexuiz 2.5.2/nexuiz-252.zip
    sha512: da661eb2ff1764fed1d5f5547b89e4f9aa47613d41a3999c0202d8858ec2b882e4ef0ec182a81d1bdb25dff2ef65aad6af132009884e3557206941a736c2a68c

- name: launcher
  buildsystem: simple
  build-commands:
  - mv launcher.sh /app/bin/launcher.sh
  sources:
  - type: file
    path: launcher.sh

- name: icon-install
  buildsystem: simple
  build-commands:
    - |
      for s in 16 24 32 48 256; do
        install -Dm644 icons/hicolor/${s}x${s}/apps/com.alientrap.nexuiz-classic.png -t /app/share/icons/hicolor/${s}x${s}/apps/
      done
  sources:
    - type: file
      path: icons/hicolor/16x16/apps/com.alientrap.nexuiz-classic.png
    - type: file
      path: icons/hicolor/24x24/apps/com.alientrap.nexuiz-classic.png
    - type: file
      path: icons/hicolor/32x32/apps/com.alientrap.nexuiz-classic.png
    - type: file
      path: icons/hicolor/48x48/apps/com.alientrap.nexuiz-classic.png
    - type: file
      path: icons/hicolor/256x256/apps/com.alientrap.nexuiz-classic.png

- name: desktop-integration
  buildsystem: simple
  build-commands:
  - mkdir -p /app/share/metainfo /app/share/applications
  - mv com.alientrap.nexuiz-classic.metainfo.xml /app/share/metainfo/
  - mv com.alientrap.nexuiz-classic.desktop /app/share/applications/
  sources:
  - type: file
    path: com.alientrap.nexuiz-classic.metainfo.xml
  - type: file
    path: com.alientrap.nexuiz-classic.desktop
